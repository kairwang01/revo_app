<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#43CD80">
  <title>Checkout - Revo</title>
  
  <link rel="stylesheet" href="./assets/css/tokens.css">
  <link rel="stylesheet" href="./assets/css/base.css">
  <link rel="stylesheet" href="./assets/css/layout.css">
  <link rel="stylesheet" href="./assets/css/components.css">
  <link rel="stylesheet" href="./assets/css/pages.css">
  
  <link rel="icon" type="image/svg+xml" href="./favicon.svg">
  <style>
    .shipping-option {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-lg, 16px);
      margin-bottom: 0.75rem;
      cursor: pointer;
      transition: border var(--transition-base, 250ms ease), box-shadow var(--transition-base, 250ms ease);
    }

    .shipping-option.selected {
      border-color: var(--brand-500);
      box-shadow: 0 12px 24px rgba(34, 179, 122, 0.12);
    }

    .shipping-option input {
      accent-color: var(--brand-500);
    }

    .shipping-option .shipping-cost {
      font-weight: 600;
      color: var(--brand-600);
    }
</style>
</head>
<body>
  <!-- checkout tunnel, almost there! -->
  <!-- Header -->
  <header class="app-header">
    <div class="header-left">
      <a href="./cart.html" class="icon-btn">
        <span style="font-size: 1.25rem;">←</span>
        <span class="sr-only">Back to Cart</span>
      </a>
    </div>
    <div class="header-center">
      <h1 style="font-size: 1rem; font-weight: 600;">Checkout</h1>
    </div>
    <div class="header-right"></div>
  </header>

  <!-- Main Content -->
  <main class="page-wrapper">
    <div class="container">
      <!-- Delivery Address -->
      <section class="checkout-section">
        <h3>Delivery Address</h3>
        <div id="address-list" class="stack-sm"></div>
        <p id="address-empty" class="text-muted hidden" style="font-size: 0.875rem;">
          No saved addresses yet. Add one to continue with checkout.
        </p>
        <button type="button" class="btn btn-ghost btn-sm" style="margin-top: 0.75rem;" id="add-address-btn">
          + Add New Address
        </button>
        <form id="address-form" class="address-form hidden" novalidate>
          <div class="address-form-intro">
            <div>
              <div class="address-form-title" data-form-title>Add new address</div>
              <p class="address-form-hint" data-form-hint>Saved addresses help you checkout even faster.</p>
            </div>
          </div>
          <div class="address-form-row">
            <label>
              Full Name
              <input type="text" name="full_name" autocomplete="name" required>
            </label>
            <label>
              Phone Number
              <input type="tel" name="phone_number" autocomplete="tel" required>
            </label>
          </div>
          <div class="address-form-row">
            <label>
              Address Line 1
              <input type="text" name="address_line1" autocomplete="address-line1" required>
            </label>
            <label>
              Address Line 2
              <input type="text" name="address_line2" autocomplete="address-line2">
            </label>
          </div>
          <div class="address-form-row">
            <label>
              City
              <input type="text" name="city" autocomplete="address-level2" required>
            </label>
            <label>
              Province / State
              <input type="text" name="state" autocomplete="address-level1" required>
            </label>
            <label>
              Postal Code
              <input type="text" name="postal_code" autocomplete="postal-code" required>
            </label>
          </div>
          <div class="address-form-row">
            <label>
              Country
              <input type="text" name="country" value="Canada" autocomplete="country" required>
            </label>
            <label class="address-checkbox">
              <input type="checkbox" name="is_default">
              <span>Set as default address</span>
            </label>
          </div>
          <div class="address-form-actions">
            <button type="button" class="btn btn-secondary btn-sm" data-action="cancel-address">Cancel</button>
            <button type="submit" class="btn btn-primary btn-sm">Save Address</button>
          </div>
        </form>
      </section>

      <!-- Payment Method -->
      <section class="checkout-section">
        <h3>Payment Method</h3>
        
        <label class="payment-method selected">
          <input type="radio" name="payment" value="card" checked>
          <div>
            <div style="font-weight: 600;">Credit/Debit Card</div>
            <div class="text-muted" style="font-size: 0.875rem;">Visa, Mastercard, Amex</div>
          </div>
        </label>
        
        <label class="payment-method">
          <input type="radio" name="payment" value="wallet">
          <div>
            <div style="font-weight: 600;">Revo Wallet</div>
            <div class="text-muted" style="font-size: 0.875rem;">Balance: $<span id="wallet-balance">0.00</span> CAD</div>
          </div>
        </label>
        
        <label class="payment-method">
          <input type="radio" name="payment" value="cod">
          <div>
            <div style="font-weight: 600;">Cash on Delivery</div>
            <div class="text-muted" style="font-size: 0.875rem;">Pay when you receive</div>
          </div>
        </label>
      </section>

      <!-- Shipment -->
      <section class="checkout-section">
        <h3>Shipment</h3>
        <div id="shipping-options">
          <label class="shipping-option selected" data-shipping="regular">
            <input type="radio" name="shipping" value="regular" checked>
            <div style="flex: 1;">
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <div style="font-weight:600;">Canada Post Regular</div>
                <div class="shipping-cost" data-cost="regular">Free</div>
              </div>
              <div class="text-muted" style="font-size:0.85rem;">Tracked delivery · 2-4 business days</div>
            </div>
          </label>
          <label class="shipping-option" data-shipping="fast">
            <input type="radio" name="shipping" value="fast">
            <div style="flex: 1;">
              <div style="display:flex; justify-content:space-between; align-items:center;">
                <div style="font-weight:600;">FedEx Express</div>
                <div class="shipping-cost" data-cost="fast">$24.99</div>
              </div>
              <div class="text-muted" style="font-size:0.85rem;">Priority delivery · 1-2 business days</div>
            </div>
          </label>
        </div>
      </section>

      <!-- Order Summary -->
      <section class="checkout-section">
        <h3>Order Summary</h3>
        
        <div id="order-items" class="stack-sm">
          <!-- Items will be loaded dynamically -->
        </div>
        
        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
          <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
            <span class="text-muted">Subtotal</span>
            <span id="checkout-subtotal">$0.00</span>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
            <span class="text-muted">Tax (<span id="checkout-tax-rate">12</span>%)</span>
            <span id="checkout-tax">$0.00</span>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
            <span class="text-muted">Shipping</span>
            <span id="checkout-shipping">Free</span>
          </div>
          <div class="text-muted" style="font-size: 0.8rem; margin-bottom: 0.75rem;" id="checkout-shipping-selected">
            Canada Post Regular · 2-4 business days
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-top: 1rem; padding-top: 1rem; border-top: 2px solid var(--border-strong);">
            <strong>Total</strong>
            <strong id="checkout-total" style="color: var(--brand-600); font-size: 1.25rem;">$0.00</strong>
          </div>
        </div>
      </section>

      <!-- Place Order Button -->
      <section style="margin-top: 2rem; margin-bottom: 2rem;">
        <button class="btn btn-primary btn-full btn-lg" id="place-order-btn">
          Place Order
        </button>
        
        <p class="text-muted text-center" style="font-size: 0.75rem; margin-top: 1rem;">
          By placing your order, you agree to Revo's
          <a href="#" style="color: var(--brand-600);">Terms & Conditions</a>
        </p>
      </section>
    </div>
  </main>

  <script src="./assets/js/storage.js"></script>
  <script src="./assets/js/config.js"></script>
  <script src="./assets/js/backendApi.js"></script>
  <script src="./assets/js/api.js"></script>
  <script src="./assets/js/ui.js"></script>
  <script src="./assets/js/pages/checkout.js"></script>
</body>
</html>
